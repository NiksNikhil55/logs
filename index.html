document.getElementById('fiForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const data = {
        fiDate: document.getElementById('fiDate').value,
        wheelsId: document.getElementById('wheelsId').value,
        customerName: document.getElementById('customerName').value,
        contactNo: document.getElementById('contactNo').value,
        resiAddress: document.getElementById('resiAddress').value,
        resiPinCode: document.getElementById('resiPinCode').value,
        officeAddress: document.getElementById('officeAddress').value,
        officePinCode: document.getElementById('officePinCode').value,
        particulars: document.getElementById('particulars').value,
        pan: document.getElementById('pan').value
    };

    try {
        const response = await fetch('https://script.google.com/macros/s/AKfycby0DHD7XJIVCws7xbn8Rn6UJbvCMQG8qGIJaWs_FIOxMWdNQeiUqmd9J6dUbvYfSufH8A/exec', {
            method: 'POST',
            body: JSON.stringify(data),
            headers: {
                'Content-Type': 'application/json',
            },
            mode: 'cors',
        });

        // Log the response status and text for debugging
        console.log('Response Status:', response.status);
        const responseBody = await response.text();  // get the text response
        console.log('Response Body:', responseBody);

        if (response.ok) {
            alert('Data submitted successfully!');
        } else {
            alert('Failed to submit data. Error: ' + responseBody);
            console.error('Error response:', responseBody);
        }
    } catch (error) {
        console.error('Fetch error:', error);
        alert('An error occurred while submitting the data.');
    }
});
